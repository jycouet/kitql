import { Callout } from '@theguild/components'

# ‚ö°How to - `vite-plugin-kit-routes`

`vite-plugin-kit-routes` automatically updates route references in SvelteKit projects, crucial for
large applications where manual tracking of route changes is error-prone. It simplifies development
by ensuring all route links are consistent and up-to-date, saving time and preventing broken links.

You will essentially have 3 objects at your disposal: `PAGES`, `SERVERS` and `ACTIONS` and instead
of hardcode strings, you will use these objects that are always up to date with your routes.

No more ü§û, now be confident ‚úÖ!

By default, no Configuration is requiered. Just [Install](#installation) the plugin, and use objects
available in your `$lib/ROUTES.ts` generated file _(always in sync)_.

## Examples

```svelte filename="PAGES - First example" {2, 9}
<script lang="ts">
  import { PAGES } from '$lib/ROUTES'
</script>

<!-- ü§û before, random string -->
<a href="/terms-and-conditions">Terms</a>

<!-- ‚úÖ after, make sure it exist. // 'vite-plugin-kit-routes' -->
<a href={PAGES['/terms-and-conditions']}>Terms</a>
<!-- 
   If you change location of `/terms-and-conditions/+page.svelte`: 
     - the key '/terms-and-conditions' will not exist
     - `PAGES` object will yield! 
-->
```

```svelte filename="PAGES - With 1 route param" {2, 9}
<script lang="ts">
  import { PAGES } from '$lib/ROUTES'
</script>

<!-- ü§û before, random string -->
<a href="/site_contract/{siteId}">Go to site</a>

<!-- ‚úÖ after, all typed & make sure it exist. // 'vite-plugin-kit-routes' -->
<a href={PAGES['/site_contract/{siteId}']({ siteId })}>Go to site</a>
```

```svelte filename="PAGES - With 1 Search Param*" {2, 9}
<script lang="ts">
  import { PAGES } from '$lib/ROUTES'
</script>

<!-- ü§û before, random string -->
<a href="/site_contract/{siteId}?limit={3}">Go to site</a>

<!-- ‚úÖ after, all typed & make sure it exist. // 'vite-plugin-kit-routes' -->
<a href={PAGES['/site_contract/{siteId}']({ siteId, limit: 3 })}>Go to site</a>
```

<em>* You can add a lot of configs to specify search params, types, ...</em>

```svelte filename="ACTIONS - With a named action" {4, 12}
<script lang="ts">
  import { enhance } from '$app/forms'
  import { page } from '$app/stores'
  import { ACTIONS } from '$lib/ROUTES'

  const siteId = $page.params.siteId

  // ü§û before, random string
  const action =  `/site_contract/${siteId}?/sendSomething`

  // ‚úÖ after, all typed & make sure it exist. // 'vite-plugin-kit-routes',
  const action = ACTIONS['/site_contract/${siteId}']('sendSomething', { siteId })
</script>

<form method="POST" use:enhance {action}>
  <button>Check</button>
</form>
```

## Installation

```sh npm2yarn
npm i -D vite-plugin-kit-routes
```

## Configuration

Add the plugin like this:

```js filename="vite.config.js" {2, 9}
import { sveltekit } from '@sveltejs/kit/vite'
import { kitRoutes } from 'vite-plugin-kit-routes'

/** @type {import('vite').UserConfig} */
const config = {
  plugins: [
    sveltekit(),
    // ‚úÖ Add the plugin
    kitRoutes()
  ]
}

export default config
```

It will generate a file `./src/lib/ROUTES.ts` at the start of your dev server & any update of any of
your `+page.svelte` | `+server.ts` | `+page.server.ts`.

## Side Notes

<Callout>You can make use of `ctrl + space` to discover config options. üéâ</Callout>

- What kind of person are you: `PAGES['/terms']` or `PAGES.terms` ?

_You can choose anyway üòú_

```ts filename="vite.config.ts"
kitRoutes({
  // object_keys_format: '/' (default)
  object_keys_format: '_'
})
```

- You like nice and formated files? You can add **any** cmd after the generation

```ts filename="vite.config.ts"
kitRoutes({
  post_update_run: 'npm exec prettier ./src/lib/ROUTES.ts -- -w'
})
```

- You can specify a searchParam for some paths _(you can also do it globally)_

```ts filename="vite.config.ts"
kitRoutes({
  extend: {
    PAGES: {
      site: {
        explicit_search_params: {
          limit: { type: 'number' }
        }
      }
    }
  }
})
```

- You can narrow down the type of params _(You can also change `"string | number"` default
  globally)_

```ts filename="vite.config.ts"
kitRoutes({
  extend: {
    PAGES: {
      site_id: {
        params: {
          id: { type: 'string' }
        }
      }
    }
  }
})
```

- Then, you can add the `KIT_ROUTES` type... It will be crazy good! I'm not sure you are ready!

```ts filename="vite.config.ts"
import type { KIT_ROUTES } from '$lib/ROUTES'
import { kitRoutes } from 'vite-plugin-kit-routes'

kitRoutes<KIT_ROUTES>({
  // Conf
})
```

---

Let me know what I forgot to add on [TwiX](https://twitter.com/jycouet), or what you would like to
see in the future. üôè
